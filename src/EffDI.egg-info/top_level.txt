pre_compute_weights
